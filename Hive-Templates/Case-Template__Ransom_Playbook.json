{"_id":"~204943416","createdBy":"taylor.walton@socfortress.co","updatedBy":"taylor.walton@socfortress.co","createdAt":1663791172492,"updatedAt":1663791878502,"_type":"caseTemplate","name":"Ransom Playbook","displayName":"","titlePrefix":"","description":"# **Ransom Playbook**             ![TAG](https://img.shields.io/badge/CRITICAL-Potential%20Ransomware%20Detected-red) [![Ransom Playbook][ransomplaybook-shield]][ransomplaybook-url] [![Investigate][investigate-shield]][investigate-url] \n\n[![Help Desk][helpdesk-shield]][helpdesk-url] \n\n### **1. Ransom - Detect**\n[![Ransom Detect](https://github.com/socfortress/Playbooks/raw/main/IRP-Ransom/Workflows/Ransom-Workflow-Detect.png \"Ransom Detect\")](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom#2-detect)\n\n\n### **2. Ransom - Analyze**\n[![Ransom Analyze](https://github.com/socfortress/Playbooks/raw/main/IRP-Ransom/Workflows/Ransom-Workflow-Analyze.png \"Ransom Analyze\")](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom#3-analyze)\n\n\n### **3. Ransom - Contain/Eradicate**\n[![Ransom Contain/Eradicate](https://github.com/socfortress/Playbooks/raw/main/IRP-Ransom/Workflows/Ransom-Workflow-Contain_Eradicate.png \"Ransom Contain/Eradicate\")](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom#4-contain--eradicate)\n\n\n### **4. Ransom - Recover**\n[![Ransom Recover](https://github.com/socfortress/Playbooks/raw/main/IRP-Ransom/Workflows/Ransom-Workflow-Recover.png \"Ransom Recover\")](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom#5-recover)\n\n\n### **5. Ransom - Post Incident**\n[![Ransom Post Incident](https://github.com/socfortress/Playbooks/raw/main/IRP-Ransom/Workflows/Ransom-Workflow-Post_Incident.png \"Ransom Post Incident\")](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom#6-post-incident)\n\n\n[helpdesk-shield]: https://img.shields.io/badge/SOCFortress-Help%20Desk-blue\n[helpdesk-url]: https://servicedesk.socfortress.co/help/2979687893\n[ransomplaybook-shield]: https://img.shields.io/badge/Ransom%20Playbook-Open%20In%20GitHub-orange\n[ransomplaybook-url]: https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom\n[investigate-shield]: https://img.shields.io/badge/INVESTIGATE-Take%20me%20to%20Forensic%20Analysis-green\n[investigate-url]: https://investigate.socfortress.co/app/index.html?#/search/all","severity":3,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"id":"~123027528","_id":"~123027528","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878452,"_type":"case_task","title":"RD4. Triage","group":"Detect","description":"Determine\n- Impact\n    - Of \n    - Financial\n    - Data loss\n- Scope (Nb of people)\n","status":"Waiting","flag":false,"order":3},{"id":"~123031624","_id":"~123031624","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878460,"_type":"case_task","title":"RA17. Scope Validation","group":"Analyze","description":"Have all the machines been identified? \nIf you find futher traces of phishing or new IOCs go back through this step.  \n\nWhen you are done identifying all compromised:  \n- Hosts\n- Data\n\nYou can continue to the next phase. \n","status":"Waiting","flag":false,"order":15},{"id":"~164040864","_id":"~164040864","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878459,"_type":"case_task","title":"RA16. Update Scope","group":"Analyze","description":"- Update lists of\n    - affected endpoints\n    - affected Company Entities\n    - affected clients","status":"Waiting","flag":false,"order":14},{"id":"~164044960","_id":"~164044960","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878461,"_type":"case_task","title":"RA19. Technical Help","group":"Analyze","description":"The Incident Commander can reach out to a 3rd Party Incident Responder\n- xxxx@yyyy.com\n- 555-555-1212","status":"Waiting","flag":false,"order":17},{"id":"~164049056","_id":"~164049056","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878492,"_type":"case_task","title":"RP4. Update & Upgrade Defenses","group":"Post Incident","description":"Various security solutions might need to be updated or upgraded to prevent a similar incident from occuring again.\n\nHere are a few items to consider:\n- Anti-Virus\n    - Signatures\n    - Engine\n- EDR\n    - Behaviour (TTP)\n    - Custom Detection\n- Anti-Spam \n    - Filter\n- Anti-Phishing","status":"Waiting","flag":false,"order":37},{"id":"~204959800","_id":"~204959800","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878458,"_type":"case_task","title":"RA12. Do We Pay the Ransom?","group":"Analyze","description":"Depending on the state of the backups, the type of devices that was encrypted, we might need to pay the ransom.  \n**NOTE**: This decision must be taken by the Board (or the client(s)), but we are here to help advice.  \n\nHere a some things think about if we decide to pay:\n- Will the insurer cover/reimburse?\n- Most of threat actors are open to negotiation and we should **always** negotiate the price down\n- We need to get Bitcoin on a trusted exchange","status":"Waiting","flag":false,"order":11},{"id":"~204963896","_id":"~204963896","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878459,"_type":"case_task","title":"RA15. Were All Endpoints and Data Identified?","group":"Analyze","description":"If we have found new affected endpoints or data go to the next section. \n\nIf we have identified all endpoints and data you can jump to [Do we need external help](README.md#ra18-external-help)\n- Update FW, IDS, etc. rules w/ IOCs\n- Search endpoints for IOCs w/ EDR\n","status":"Waiting","flag":false,"order":13},{"id":"~245928112","_id":"~245928112","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878461,"_type":"case_task","title":"RA18. External Help","group":"Analyze","description":"Does Company have all the knowledge and ressources to handle the crisis alone?","status":"Waiting","flag":false,"order":16},{"id":"~245932208","_id":"~245932208","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878466,"_type":"case_task","title":"RC4. Disconnect Share Drives","group":"Contain / Eradicate","description":"- All shared drive must be disconnected","status":"Waiting","flag":false,"order":24},{"id":"~245936304","_id":"~245936304","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878486,"_type":"case_task","title":"RR4. Rebuild Systems","group":"Recover","description":"- Install OS from Clean Media\n- Can we upgrade OS?","status":"Waiting","flag":false,"order":32},{"id":"~245944400","_id":"~245944400","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878449,"_type":"case_task","title":"RD1. Identify Threat Indicators","group":"Detect","description":"#### Alerts\nAlerts are be generated by differents systems owned by the Security/SOC team. The main sources for alerts are  \n- Tickets\n- SIEM\n- Anti-Virus / EDR\n- Reports\n    - DNS\n    - Web Proxy\n- Errors from mail servers\n\n#### Notifications\nNotifications are comming from external sources usually via email, Teams or phone. The main sources for notifications are  \n- Users (internal)\n- Recipents of emails (external)\n- Third Parties\n- ISP\n- Mail Providers","status":"Waiting","flag":false,"order":0},{"id":"~245948496","_id":"~245948496","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878457,"_type":"case_task","title":"RA11. Identify Affected Systems Type","group":"Analyze","description":"In order to remediate properly and engage the right team(s) we need to understand which type of systems were affected: \n- Servers\n    - OS version\n    - Kernel\n- Workstations\n    - OS version\n    - Service Pack\n- Databases\n- Share Drives\n- SAN\n- Backups\n- Etc.","status":"Waiting","flag":false,"order":10},{"id":"~245948552","_id":"~245948552","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878465,"_type":"case_task","title":"RC2. Stop Backups","group":"Contain / Eradicate","description":"- Check status of Snapshots","status":"Waiting","flag":false,"order":22},{"id":"~245952592","_id":"~245952592","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878462,"_type":"case_task","title":"RA21. Legal Help","group":"Analyze","description":"If there are Legal implication such as\n- GDPR\n- Criminal Charges\n- Regulation\n- Laws\n\nThe Incident Commander can reach out to a Breach Coach / Cyber Insurer\n- aaa@bbb.com\n- 555-555-1212","status":"Waiting","flag":false,"order":18},{"id":"~245952648","_id":"~245952648","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878467,"_type":"case_task","title":"RC5. Malware Infection","group":"Contain / Eradicate","description":"- If there is a Malware infection run the [Malware Playbook](https://github.com/socfortress/Playbooks/tree/main/IRP-Malware)","status":"Waiting","flag":false,"order":25},{"id":"~245956688","_id":"~245956688","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878494,"_type":"case_task","title":"RP6. Modifify Base Images","group":"Post Incident","description":"If the Ransom was caused by a lack of hardening or sufficient patch level: \n- Review hardening processes\n- Include critical patches in base Images\n- etc. ","status":"Waiting","flag":false,"order":39},{"id":"~245956744","_id":"~245956744","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878469,"_type":"case_task","title":"RC9. New IOC Discovered","group":"Contain / Eradicate","description":"- Go back to [Ransom Analyze](https://github.com/socfortress/Playbooks/tree/main/IRP-Ransom)","status":"Waiting","flag":false,"order":28},{"id":"~245960840","_id":"~245960840","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878470,"_type":"case_task","title":"RR1. Update Defenses","group":"Recover","description":"Determine which of the following actions need to be performed:  \n- Lift Containment\n- Proxy Block\n- Firewall Rules\n- Reconnect Shared Drives\n- Re-enable Backup Links\n- Enable Network Interfaces\n- Update EDR/AV\n    - Engine\n    - Policies\n    - Definitions","status":"Waiting","flag":false,"order":29},{"id":"~245964936","_id":"~245964936","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878484,"_type":"case_task","title":"RR2. Change All Passwords","group":"Recover","description":"- Change krbtgt Password\n- Reset All Priviledge Accounts","status":"Waiting","flag":false,"order":30},{"id":"~245969032","_id":"~245969032","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878485,"_type":"case_task","title":"RR3. Remove","group":"Recover","description":"- VPN\n- Jumpbox\n- Citrix","status":"Waiting","flag":false,"order":31},{"id":"~245973128","_id":"~245973128","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878489,"_type":"case_task","title":"RP1. Incident Review","group":"Post Incident","description":"- What worked\n- What didn't work","status":"Waiting","flag":false,"order":34},{"id":"~327803024","_id":"~327803024","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878455,"_type":"case_task","title":"RA6. Do We Have Backup?","group":"Analyze","description":"If we have backups, we must make sure they are protected and not overriten. Here's some of the steps that needs to be taken:\n- Disable future backups\n    - Disable backup Interface\n    - Stop backup scheduling\n- Make an offline copy of the backup","status":"Waiting","flag":false,"order":7},{"id":"~327807120","_id":"~327807120","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878456,"_type":"case_task","title":"RA10. Identify Threat Actor/Ransomware Familly","group":"Analyze","description":"Using the various artefacts, we need to identify who our adversary is. This will help\n- Know the TTP they typically use\n- Potentially indetify the Initial Access technique\n- Understand how they move laterally\n    - WMI\n    - PSExec\n    - RDP\n    - Etc.\n- Understand the effect of a reboot on the machine\n- Is there a known decryptor\n    - This is increasingly less frequent\n- Which OS version are targeted\n\nThings that we can use to identify the adversary: \n- Ransomware note\n- Malware payload\n- Encrypted file extentions\n- Email / Web portal\n- Bitcoin addresses\n- etc.","status":"Waiting","flag":false,"order":9},{"id":"~327811216","_id":"~327811216","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878458,"_type":"case_task","title":"RA14. Was Data Exfiltrated?","group":"Analyze","description":"If data was exfiltrated we need to refer to the the [Data Loss Playbook](https://github.com/socfortress/Playbooks/tree/main/IRP-DataLoss) ","status":"Waiting","flag":false,"order":12},{"id":"~327815312","_id":"~327815312","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878463,"_type":"case_task","title":"RA23. Root Cause Analysis","group":"Analyze","description":"Identify how this incident happened. \n- Phishing Emails\n- Voice Phishing\n- Drive-by Download\n- Vulnerability\n    - Remote Code Execution\n    - Cross-Site Scripting\n- Remote Services\n    - Default / Weak Password\n    - Brute Force\n    - Vulnerability\n- Lost Device\n- Human Error","status":"Waiting","flag":false,"order":19},{"id":"~327819408","_id":"~327819408","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878468,"_type":"case_task","title":"RC6. Active Directory Clean Up","group":"Contain / Eradicate","description":"In most cases these actions should be sufficient:\n- Change kbrtgt Password twice\n- Reset All Privilege Accounts\n\nIn cases where we beleive Domain Admin account(s) were compromised we have to do the following **before** the steps above: \n- Restore the AD from backup that predate the initial compromised\n- If no backup exists:\n    - Consider rebuiling the AD from scratch. \n    - Change how we protect sensitive Accounts\n\nThe decision to rebuilt from strach should come from the higher management of the Global-Security Team or of the client's security team.","status":"Waiting","flag":false,"order":26},{"id":"~327823504","_id":"~327823504","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878469,"_type":"case_task","title":"RC7. Monitor Closely","group":"Contain / Eradicate","description":"- Monitor for:\n    - Lateral Movement\n    - Privilege Escalation\n    - IOCs\n    - etc.","status":"Waiting","flag":false,"order":27},{"id":"~327827600","_id":"~327827600","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878491,"_type":"case_task","title":"RP3. Review Defensive Posture","group":"Post Incident","description":"- Schedule review of newly introduced rules in6 months\n- Are the following still applicatble\n    - Firewall Rules\n    - Proxy Rules for C2\n    - AV / EDR custom Signatures\n    - IPS Signatures","status":"Waiting","flag":false,"order":36},{"id":"~327831696","_id":"~327831696","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878493,"_type":"case_task","title":"RP5. Build New Detection","group":"Post Incident","description":"If the incident was detected late in the Kill Chain, we need to try to improve our detection to catch a similar incident earlier.\n\nWe could for instance: \n- Create SIEM rules\n- Generate SNOW tickets\n- Create Miro Plays \n- etc.","status":"Waiting","flag":false,"order":38},{"id":"~327835792","_id":"~327835792","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878495,"_type":"case_task","title":"RP7. User Awareness Training","group":"Recover","description":"If the incident was caused by a human error\n- Create / Select new mandatory training\n    - From Security Education Vendor\n    - From Youtube video\n    - Built by internal teams","status":"Waiting","flag":false,"order":40},{"id":"~327839888","_id":"~327839888","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878496,"_type":"case_task","title":"RP9. Calculate Incident's Cost","group":"Post Incident","description":"Calculate the incident's Cost\n- Time Spent\n- Ransom paid\n- Downtime\n- Fines / Penalities\n- etc. ","status":"Waiting","flag":false,"order":41},{"id":"~327880736","_id":"~327880736","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878451,"_type":"case_task","title":"RD3. Data Colletion","group":"Detect","description":"Domains  \n- Reputation\n- Registrar\n- Owner\n- IP\n- Multistage / Redirect\n- Technologies of the site\n    - WordPress\n    - Joomla\n    - Custom Page (credential phish)\n\nIP  \n- Reputation\n- Owner\n- Geo Localisation\n- Other domains on that IP","status":"Waiting","flag":false,"order":2},{"id":"~327884832","_id":"~327884832","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878456,"_type":"case_task","title":"RA8. Is the infected environment (AD) trusted by other environment?","group":"Analyze","description":"In order to provent the adversaries to reach other domains that could be linked, we need to \n- Disable any Trust from that domain to others\n- In some cases, we might need to disconnect the MPLS Link\n    - This needs management approval (refer to the [Critical Playbook](https://github.com/socfortress/Playbooks/tree/main/IRP-Critical))","status":"Waiting","flag":false,"order":8},{"id":"~327888928","_id":"~327888928","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878487,"_type":"case_task","title":"RR5. Restore Data","group":"Recover","description":"- Use a clean backup","status":"Waiting","flag":false,"order":33},{"id":"~327979024","_id":"~327979024","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878450,"_type":"case_task","title":"RD2. Indentify Risks Factors","group":"Detect","description":"#### Common\n- Credential Theft\n- Malware Delivery\n- Criminal Activites\n    - Blackmail / Ransom\n\n#### Company Specific\n- Financial Losses\n    - Lost of conctrat\n    - Contract not renewed\n    - Lower bid to our clients\n    - Fines\n        - Regulation","status":"Waiting","flag":false,"order":1},{"id":"~327983120","_id":"~327983120","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878453,"_type":"case_task","title":"RA1. Verify","group":"Analyze","description":"In conjonction with a senior member of the SOC  \n- Double check previous data\n- Rule out False Positive","status":"Waiting","flag":false,"order":4},{"id":"~327987216","_id":"~327987216","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878453,"_type":"case_task","title":"RA2. Identify type of Ransom","group":"Analyze","description":"The first thing we need to do is understand which type of Ransom we are dealing with.\n- Is this a Ransomware?\n- Is this a DDoS related Ransom? \n    - For now, we do not have a DDoS Playbook, so referer to the [Critical Playbook](https://github.com/socfortress/Playbooks/tree/main/IRP-Critical)\n\nIf it's another type, you should follow the [Critical Playbook](https://github.com/socfortress/Playbooks/tree/main/IRP-Critical) and escalate to the SOC and/or Security management.","status":"Waiting","flag":false,"order":5},{"id":"~327991312","_id":"~327991312","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878454,"_type":"case_task","title":"RA4. Assess if the Threat Actor is still in the Network","group":"Analyze","description":"Depending if the actor has succesfully encrypted the data or if they are still actively trying, the speed at which we must act is different.  \nIf the actor is still in the network, the containment effort needs to be taken as fast as possible and the Contain & Eradicate actions will be intertwined with the Analysis.","status":"Waiting","flag":false,"order":6},{"id":"~327995408","_id":"~327995408","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878464,"_type":"case_task","title":"RA24. Send Communincation","group":"Analyze","description":"Contact any relevant of the following party\n- Internal Security Team\n- Affected Clients\n- Any internal teams needed for remediation or counselling","status":"Waiting","flag":false,"order":20},{"id":"~327999504","_id":"~327999504","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878465,"_type":"case_task","title":"RC1. Block Systems to Systems Communications","group":"Contain / Eradicate","description":"The first things we need to do with ransomware is to block systems to systems communincation. We can do this using various methods such as: \n- EDR containment fonction\n- Local Firewall\n    - This could be circonvented if the adversary is still on the system\n- AV/EDR Firewall\n- Shutdown Network Interface\n    - This mostly apply to VM\n- Disable the switch port on the router\n- Etc. ","status":"Waiting","flag":false,"order":21},{"id":"~328003600","_id":"~328003600","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878466,"_type":"case_task","title":"RC3. Powerdown NON Encrypted Systems","group":"Contain / Eradicate","description":"- If possible powerdown the systems that are not encrypted\n- Do NOT powerdown encrypted systems as they might not restart","status":"Waiting","flag":false,"order":23},{"id":"~328007696","_id":"~328007696","createdBy":"taylor.walton@socfortress.co","createdAt":1663791878490,"_type":"case_task","title":"RP2. Update Mode of Operations","group":"Post Incident","description":"Update the following documents as requiered:  \n- Policies\n- Processes\n- Procedures\n- Playbooks\n- Runbooks\n\nUpdate Detetion Rules in:  \n- SIEM\n- Anti-Spam\n- Malware Gataway\n- EDR\n- Other security solution","status":"Waiting","flag":false,"order":35}],"status":"Ok","customFields":{},"metrics":{}}